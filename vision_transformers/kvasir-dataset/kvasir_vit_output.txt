--------- Start  job 213743
Loading data...
Training set: 6400 samples
Validation set: 800 samples
Test set: 800 samples

Creating Vision Transformer model on cuda...
Total parameters: 85,804,808
Trainable parameters: 85,804,808

Starting training on cuda...
/opt/rh/rh-python38/root/usr/local/lib64/python3.8/site-packages/torch/utils/data/dataloader.py:557: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 1, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Epoch 1/100 - Train Loss: 1.4918, Train Acc: 45.44%
Validation - Loss: 1.2245, Acc: 50.00%
Learning Rate: 0.000300
Saved best model with validation loss: 1.2245
Epoch 2/100 - Train Loss: 1.3095, Train Acc: 50.28%
Validation - Loss: 1.2175, Acc: 52.38%
Learning Rate: 0.000293
Saved best model with validation loss: 1.2175
Epoch 3/100 - Train Loss: 1.2417, Train Acc: 53.67%
Validation - Loss: 1.2151, Acc: 57.38%
Learning Rate: 0.000271
Saved best model with validation loss: 1.2151
Epoch 4/100 - Train Loss: 1.2181, Train Acc: 55.83%
Validation - Loss: 1.1285, Acc: 58.75%
Learning Rate: 0.000238
Saved best model with validation loss: 1.1285
Epoch 5/100 - Train Loss: 1.1960, Train Acc: 57.80%
Validation - Loss: 1.1211, Acc: 61.38%
Learning Rate: 0.000197
Saved best model with validation loss: 1.1211
Epoch 6/100 - Train Loss: 1.1672, Train Acc: 58.61%
Validation - Loss: 1.1056, Acc: 64.25%
Learning Rate: 0.000150
Saved best model with validation loss: 1.1056
Epoch 7/100 - Train Loss: 1.1147, Train Acc: 62.36%
Validation - Loss: 1.0710, Acc: 64.88%
Learning Rate: 0.000104
Saved best model with validation loss: 1.0710
Epoch 8/100 - Train Loss: 1.0962, Train Acc: 62.56%
Validation - Loss: 1.0349, Acc: 67.00%
Learning Rate: 0.000063
Saved best model with validation loss: 1.0349
Epoch 9/100 - Train Loss: 1.0764, Train Acc: 64.12%
Validation - Loss: 1.0217, Acc: 67.38%
Learning Rate: 0.000030
Saved best model with validation loss: 1.0217
Epoch 10/100 - Train Loss: 1.0565, Train Acc: 66.00%
Validation - Loss: 1.0201, Acc: 68.38%
Learning Rate: 0.000008
Saved best model with validation loss: 1.0201
Epoch 11/100 - Train Loss: 1.2103, Train Acc: 56.33%
Validation - Loss: 1.0940, Acc: 65.38%
Learning Rate: 0.000300
Epoch 12/100 - Train Loss: 1.2017, Train Acc: 56.48%
Validation - Loss: 1.2271, Acc: 59.38%
Learning Rate: 0.000298
Epoch 13/100 - Train Loss: 1.1904, Train Acc: 56.94%
Validation - Loss: 1.1522, Acc: 62.38%
Learning Rate: 0.000293
Epoch 14/100 - Train Loss: 1.2079, Train Acc: 56.17%
Validation - Loss: 1.3045, Acc: 53.12%
Learning Rate: 0.000284
Epoch 15/100 - Train Loss: 1.1772, Train Acc: 58.03%
Validation - Loss: 1.1326, Acc: 61.12%
Learning Rate: 0.000271
Epoch 16/100 - Train Loss: 1.1584, Train Acc: 59.17%
Validation - Loss: 1.0913, Acc: 64.12%
Learning Rate: 0.000256
Epoch 17/100 - Train Loss: 1.1606, Train Acc: 59.25%
Validation - Loss: 1.0904, Acc: 59.75%
Learning Rate: 0.000238
Epoch 18/100 - Train Loss: 1.1580, Train Acc: 58.84%
Validation - Loss: 1.0886, Acc: 65.75%
Learning Rate: 0.000218
Epoch 19/100 - Train Loss: 1.1427, Train Acc: 60.80%
Validation - Loss: 1.0628, Acc: 65.75%
Learning Rate: 0.000197
Epoch 20/100 - Train Loss: 1.1199, Train Acc: 61.45%
Validation - Loss: 1.0562, Acc: 64.62%
Learning Rate: 0.000174
Epoch 21/100 - Train Loss: 1.1061, Train Acc: 62.91%
Validation - Loss: 1.0574, Acc: 65.00%
Learning Rate: 0.000150
Epoch 22/100 - Train Loss: 1.0915, Train Acc: 63.14%
Validation - Loss: 1.0558, Acc: 65.88%
Learning Rate: 0.000127
Epoch 23/100 - Train Loss: 1.0741, Train Acc: 64.70%
Validation - Loss: 1.0318, Acc: 66.88%
Learning Rate: 0.000104
Epoch 24/100 - Train Loss: 1.0662, Train Acc: 64.50%
Validation - Loss: 1.0026, Acc: 68.75%
Learning Rate: 0.000083
Saved best model with validation loss: 1.0026
Epoch 25/100 - Train Loss: 1.0548, Train Acc: 66.16%
Validation - Loss: 1.0115, Acc: 67.00%
Learning Rate: 0.000063
Epoch 26/100 - Train Loss: 1.0445, Train Acc: 66.31%
Validation - Loss: 1.0058, Acc: 69.50%
Learning Rate: 0.000045
Epoch 27/100 - Train Loss: 1.0326, Train Acc: 66.88%
Validation - Loss: 1.0137, Acc: 68.38%
Learning Rate: 0.000030
Epoch 28/100 - Train Loss: 1.0256, Train Acc: 67.61%
Validation - Loss: 0.9914, Acc: 69.00%
Learning Rate: 0.000017
Saved best model with validation loss: 0.9914
Epoch 29/100 - Train Loss: 1.0190, Train Acc: 67.72%
Validation - Loss: 0.9927, Acc: 70.00%
Learning Rate: 0.000008
Epoch 30/100 - Train Loss: 1.0140, Train Acc: 68.20%
Validation - Loss: 0.9877, Acc: 69.62%
Learning Rate: 0.000003
Saved best model with validation loss: 0.9877
Epoch 31/100 - Train Loss: 1.1300, Train Acc: 60.59%
Validation - Loss: 1.0941, Acc: 64.75%
Learning Rate: 0.000300
Epoch 32/100 - Train Loss: 1.1937, Train Acc: 57.61%
Validation - Loss: 1.1302, Acc: 62.00%
Learning Rate: 0.000300
Epoch 33/100 - Train Loss: 1.1667, Train Acc: 58.53%
Validation - Loss: 1.1302, Acc: 60.75%
Learning Rate: 0.000298
Epoch 34/100 - Train Loss: 1.1526, Train Acc: 59.73%
Validation - Loss: 1.1036, Acc: 65.00%
Learning Rate: 0.000296
Epoch 35/100 - Train Loss: 1.1490, Train Acc: 60.36%
Validation - Loss: 1.0862, Acc: 64.62%
Learning Rate: 0.000293
Epoch 36/100 - Train Loss: 1.1497, Train Acc: 59.27%
Validation - Loss: 1.0557, Acc: 63.75%
Learning Rate: 0.000289
Epoch 37/100 - Train Loss: 1.1486, Train Acc: 60.59%
Validation - Loss: 1.0534, Acc: 64.25%
Learning Rate: 0.000284
Epoch 38/100 - Train Loss: 1.1195, Train Acc: 61.64%
Validation - Loss: 1.0895, Acc: 60.12%
Learning Rate: 0.000278
Epoch 39/100 - Train Loss: 1.1341, Train Acc: 60.62%
Validation - Loss: 1.0825, Acc: 64.25%
Learning Rate: 0.000271
Epoch 40/100 - Train Loss: 1.1217, Train Acc: 61.80%
Validation - Loss: 1.0768, Acc: 64.00%
Learning Rate: 0.000264
Epoch 41/100 - Train Loss: 1.1230, Train Acc: 62.16%
Validation - Loss: 1.0596, Acc: 66.75%
Learning Rate: 0.000256
Epoch 42/100 - Train Loss: 1.1145, Train Acc: 61.17%
Validation - Loss: 1.1015, Acc: 62.25%
Learning Rate: 0.000248
Epoch 43/100 - Train Loss: 1.1019, Train Acc: 62.19%
Validation - Loss: 1.0437, Acc: 68.00%
Learning Rate: 0.000238
Epoch 44/100 - Train Loss: 1.1086, Train Acc: 62.22%
Validation - Loss: 1.0291, Acc: 67.38%
Learning Rate: 0.000229
Epoch 45/100 - Train Loss: 1.0920, Train Acc: 62.97%
Validation - Loss: 1.0129, Acc: 66.62%
Learning Rate: 0.000218

Early stopping triggered after 45 epochs

Training completed in 1:32:09.335181

Training history saved to 'vit_training_history.csv'

Evaluating model on test set...

Classification Report:
                        precision  recall  f1-score
dyed-lifted-polyps       0.727273   0.640  0.680851
dyed-resection-margins   0.672727   0.740  0.704762
esophagitis              0.684211   0.650  0.666667
normal-cecum             0.720000   0.900  0.800000
normal-pylorus           0.783784   0.870  0.824645
normal-z-line            0.602041   0.590  0.595960
polyps                   0.625000   0.700  0.660377
ulcerative-colitis       0.770492   0.470  0.583851
accuracy                 0.695000   0.695  0.695000
macro avg                0.698191   0.695  0.689639
weighted avg             0.698191   0.695  0.689639

Overall Metrics:
Accuracy: 0.6950
Macro Precision: 0.6982
Macro Recall: 0.6950
Macro F1-Score: 0.6896

Confusion matrix saved to 'vit_confusion_matrix.csv'

Classification report saved to 'vit_classification_report.csv'

Model and results saved successfully.
3. ------- Calculate time elapsed ------- 
Total of 5558 seconds elapsed for process
--------- Finished with job 213743
